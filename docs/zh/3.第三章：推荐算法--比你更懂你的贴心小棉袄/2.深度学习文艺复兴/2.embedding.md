---
title: Embeddingï¼šä»æ–‡æœ¬åˆ°æ¨èçš„è¯­ä¹‰æ¡¥æ¢
createTime: 2025/06/12 10:00:00
---

åœ¨æ¨èç³»ç»Ÿçš„è¿œå¤æ—¶ä»£ï¼Œè®¡ç®—æœºçœ¼é‡Œçš„ä¸–ç•Œæ˜¯ç¦»æ•£ä¸”æ— æƒ…çš„ã€‚å®ƒå¦‚ä½•è¯†åˆ«ä¸€ä¸ªå•†å“ï¼Ÿç­”æ¡ˆæ˜¯ï¼š**One-Hotç¼–ç **ã€‚

æƒ³è±¡ä¸€ä¸ªæ‹¥æœ‰100ä¸‡å•†å“çš„å¤§å‹ç”µå•†å¹³å°ï¼š
- **iPhone 14** çš„ç¼–ç å¯èƒ½æ˜¯ `[0, 0, ..., 1, ..., 0, 0]` (åœ¨ç¬¬8888ä¸ªä½ç½®æ˜¯1)
- **åä¸º Mate 60** çš„ç¼–ç å¯èƒ½æ˜¯ `[0, 1, ..., 0, ..., 0, 0]` (åœ¨ç¬¬12345ä¸ªä½ç½®æ˜¯1)
- **ä¸€æœ¬ã€Šä¸‰ä½“ã€‹** çš„ç¼–ç å¯èƒ½æ˜¯ `[0, 0, ..., 0, ..., 1, 0]` (åœ¨ç¬¬54321ä¸ªä½ç½®æ˜¯1)

è¿™å¥—ç³»ç»Ÿæœ‰ä¸¤ä¸ªè‡´å‘½ç¼ºé™·ï¼š
1.  **è¯­ä¹‰çš„çœŸç©º**ï¼šä»æ•°å­¦ä¸Šçœ‹ï¼Œ`iPhone 14` å’Œ `åä¸º Mate 60` çš„å‘é‡æ˜¯å®Œå…¨æ­£äº¤çš„ï¼Œå®ƒä»¬çš„è·ç¦»å’Œ `iPhone 14` ä¸ `ä¸‰ä½“` æ˜¯ä¸€æ ·è¿œçš„ã€‚è®¡ç®—æœºå®Œå…¨æ˜¯ä¸ª"è„¸ç›²"ï¼Œæ— æ³•ç†è§£å•†å“ä¹‹é—´çš„ä»»ä½•å…³è”ã€‚
2.  **ç»´åº¦çš„è¯…å’’**ï¼šå‘é‡å·¨å¤§ä¸”æå…¶ç¨€ç–ï¼Œè¿™å¯¹äºå­˜å‚¨å’Œè®¡ç®—éƒ½æ˜¯ä¸€åœºç¾éš¾ã€‚

ä¸ºäº†è§£å†³è¯­ä¹‰é—®é¢˜ï¼Œäººä»¬å°è¯•äº†**äººå·¥æ‰“æ ‡ç­¾**ï¼Œå°±åƒç»™æ¯ä¸ªå•†å“éƒ½åŠä¸€å¼ "èº«ä»½è¯"ï¼ˆæ ‡ç­¾ï¼šç”µå­äº§å“ã€æ‰‹æœºã€Apple...ï¼‰ã€‚ä½†è¿™å¤ªè€—è´¹äººåŠ›ï¼Œä¸”æ ‡ç­¾çš„ç²’åº¦å’Œè´¨é‡éƒ½éš¾ä»¥æ§åˆ¶ã€‚

ä¸–ç•Œéœ€è¦ä¸€åœºé©å‘½ï¼Œä¸€åœºèƒ½è®©è®¡ç®—æœºè‡ªåŠ¨ç†è§£ä¸‡ç‰©å…³è”çš„é©å‘½ã€‚

## åˆ›ä¸–çºªï¼šWord2Vec ä¸"ä¸Šä¸‹æ–‡"çš„ç¥è°• âœ¨

é©å‘½çš„æ›™å…‰æ¥è‡ªçœ‹ä¼¼æ¯«ä¸ç›¸å…³çš„NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰é¢†åŸŸã€‚2013å¹´ï¼ŒGoogleçš„Word2Vecå¸¦æ¥äº†ç¥è°•ï¼š

> **ä¸€ä¸ªè¯çš„æ„ä¹‰ï¼Œç”±å…¶å‘¨å›´çš„è¯æ¥å®šä¹‰ (Context is King)ã€‚**

è¿™ä¸ªæ€æƒ³ç®€å•å´é¢ è¦†è®¤çŸ¥ã€‚æ¯”å¦‚ï¼Œåœ¨æµ·é‡æ–‡æœ¬ä¸­ï¼š
- "å›½ç‹" å¸¸å¸¸å’Œ "ç‹å"ã€"æƒåŠ›"ã€"å›½å®¶" ä¸€èµ·å‡ºç°ã€‚
- "çš‡å¸" ä¹Ÿå¸¸å¸¸å’Œ "çš‡å"ã€"æƒåŠ›"ã€"å›½å®¶" ä¸€èµ·å‡ºç°ã€‚

é‚£ä¹ˆï¼Œæ¨¡å‹å°±èƒ½è‡ªåŠ¨æ¨æ–­å‡ºï¼š"å›½ç‹"å’Œ"çš‡å¸"çš„è¯­ä¹‰æ˜¯ç›¸è¿‘çš„ã€‚

Word2Vecåšçš„ï¼Œå°±æ˜¯æŠŠæ¯ä¸ªè¯è¯­ï¼Œä»é«˜ç»´ç¨€ç–çš„One-Hotå‘é‡ï¼Œ**"é™ç»´æ‰“å‡»"** æˆä¸€ä¸ªä½ç»´ï¼ˆæ¯”å¦‚300ç»´ï¼‰çš„ç¨ å¯†å‘é‡â€”â€”è¿™ï¼Œå°±æ˜¯ **Embedding**ã€‚

## "è¯­ä¹‰å®‡å®™"ï¼šEmbeddingç©ºé—´çš„å¥‡å¦™æ³•åˆ™ ğŸŒŒ

è¿™ä¸ªç”±Embeddingå‘é‡æ„æˆçš„ä½ç»´ç©ºé—´ï¼Œå¦‚åŒä¸€ä¸ª"è¯­ä¹‰å®‡å®™"ï¼Œéµå¾ªç€å¥‡å¦™çš„ç‰©ç†æ³•åˆ™ï¼š

#### æ³•åˆ™ä¸€ï¼šè·ç¦»ä»£è¡¨ç›¸ä¼¼æ€§
åœ¨è¿™ä¸ªå®‡å®™é‡Œï¼Œè¯­ä¹‰ç›¸è¿‘çš„ç‰©ä½“ï¼Œå®ƒä»¬çš„"ç©ºé—´åæ ‡"ï¼ˆEmbeddingå‘é‡ï¼‰ä¹Ÿç›¸äº’é è¿‘ã€‚
- `distance(å›½ç‹, çš‡å¸)` â†’ å¾ˆè¿‘
- `distance(å›½ç‹, é¦™è•‰)` â†’ å¾ˆè¿œ

#### æ³•åˆ™äºŒï¼šæ–¹å‘è•´å«å…³ç³»
å‘é‡çš„æ–¹å‘å’Œå·®å¼‚ï¼Œç«Ÿç„¶è•´å«äº†æŠ½è±¡çš„è¯­ä¹‰å…³ç³»ã€‚æœ€ç»å…¸çš„ä¾‹å­å°±æ˜¯ï¼š
> `vector(å›½ç‹) - vector(ç”·æ€§) + vector(å¥³æ€§) â‰ˆ vector(ç‹å)`

è¿™æ„å‘³ç€ï¼Œä»"å›½ç‹"çš„ä½ç½®ï¼Œæ²¿ç€"ä»ç”·æ€§æŒ‡å‘å¥³æ€§"çš„æ–¹å‘ç§»åŠ¨ï¼Œä½ å°±èƒ½åˆ°è¾¾"ç‹å"çš„é™„è¿‘ï¼è¿™ä¸ªç®€å•çš„æ•°å­¦è¿ç®—ï¼Œæ‰“å¼€äº†è¯­ä¹‰è®¡ç®—çš„å¤§é—¨ã€‚

## ä»æ–‡æœ¬åˆ°æ¨èï¼šItem2Vec çš„"æ€æƒ³è¿è·ƒ" ğŸš€

æ¨èç³»ç»Ÿçš„å¤§å¸ˆä»¬æ•é”åœ°æ„è¯†åˆ°ï¼Œè¿™ä¸ªæ€æƒ³å¯ä»¥å®Œç¾åœ°"è¿è·ƒ"åˆ°ç”µå•†é¢†åŸŸï¼š

> **ä¸€ä¸ªå•†å“çš„æ„ä¹‰ï¼Œç”±å’Œå®ƒä¸€èµ·è¢«æµè§ˆ/è´­ä¹°çš„å•†å“æ¥å®šä¹‰ã€‚**

äºæ˜¯ï¼ŒItem2Vecè¯ç”Ÿäº†ï¼š
- **è¯­æ–™åº“ (Corpus)**ï¼šä¸å†æ˜¯æ–‡ç« å¥å­ï¼Œè€Œæ˜¯ç”¨æˆ·çš„è¡Œä¸ºåºåˆ—ï¼ˆå¦‚ç‚¹å‡»åºåˆ—ã€è´­ä¹°åºåˆ—ï¼‰ã€‚
- **å•è¯ (Word)**ï¼šå˜æˆäº†å•†å“IDã€‚

ä¸€ä¸ªç”¨æˆ·çš„è´­ä¹°åºåˆ— `[iPhone, AirPods, Apple Watch]` å°±ç›¸å½“äºä¸€ä¸ªå¥å­ã€‚é€šè¿‡å­¦ä¹ å¤§é‡çš„è¿™ç±»"å¥å­"ï¼Œæ¨¡å‹è‡ªåŠ¨å­¦ä¼šäº†ï¼š
- `Embedding(iPhone)` å’Œ `Embedding(AirPods)` åœ¨ç©ºé—´ä¸­åº”è¯¥å¾ˆè¿‘ã€‚
- `vector(iPhone) - vector(Apple) + vector(å°ç±³) â‰ˆ vector(å°ç±³æ‰‹æœº)` è¿™ç§å“ç‰Œå’Œäº§å“çš„å…³ç³»ã€‚

**Embeddingï¼Œç¬¬ä¸€æ¬¡èµ‹äºˆäº†æ¯ä¸ªå•†å“ç‹¬ä¸€æ— äºŒã€å¯è®¡ç®—çš„"çµé­‚"ã€‚**

## ç°ä»£åº”ç”¨ï¼šEmbedding å¦‚ä½•é©±åŠ¨æ¨èç³»ç»Ÿï¼Ÿ ğŸ¯

åœ¨ç°ä»£æ¨èç³»ç»Ÿä¸­ï¼ŒEmbeddingæ—©å·²æˆä¸ºæ°´å’Œç”µä¸€æ ·çš„åŸºç¡€è®¾æ–½ï¼Œå…¶åº”ç”¨è´¯ç©¿å§‹ç»ˆã€‚

### é˜¶æ®µä¸€ï¼šå¬å› â€”â€” åœ¨äº¿ä¸‡å•†å“ä¸­"ç‰©ä»¥ç±»èš"

å½“ä¸€ä¸ªç”¨æˆ·æ¥è®¿æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•ä»äº¿ä¸‡å•†å“ä¸­ï¼Œå¿«é€Ÿæ‰¾åˆ°ä»–å¯èƒ½æ„Ÿå…´è¶£çš„å‡ åƒä¸ªå€™é€‰è€…ï¼Ÿç­”æ¡ˆå°±æ˜¯åˆ©ç”¨Embeddingè¿›è¡Œé«˜æ•ˆçš„ç›¸ä¼¼æ€§æœç´¢ã€‚

è¿™é€šå¸¸é€šè¿‡**åŒå¡”æ¨¡å‹ (Two-Tower Model)** å®ç°ï¼š
- **ç”¨æˆ·å¡” (User Tower)**ï¼šå°†ç”¨æˆ·çš„IDã€å†å²è¡Œä¸ºåºåˆ—ç­‰ä¿¡æ¯ï¼Œé€šè¿‡ä¸€ä¸ªç½‘ç»œï¼ˆå¦‚DNNã€RNNï¼‰è®¡ç®—å‡ºè¯¥ç”¨æˆ·çš„å®æ—¶`User Embedding`ã€‚
- **ç‰©å“å¡” (Item Tower)**ï¼šç¦»çº¿è®¡ç®—å¥½æ‰€æœ‰å•†å“çš„`Item Embedding`ã€‚

æ¨èè¿‡ç¨‹å°±å˜æˆäº†ï¼šæ‹¿ç€å®æ—¶çš„`User Embedding`ï¼Œå»åºå¤§çš„`Item Embedding`å®‡å®™ä¸­ï¼Œé€šè¿‡**è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ (ANN)** æŠ€æœ¯ï¼ˆå¦‚Faissã€HNSWï¼‰ï¼Œå…‰é€Ÿèˆ¬åœ°æ‰¾å‡ºä¸ç”¨æˆ·å‘é‡æœ€ç›¸ä¼¼çš„Top-Kä¸ªå•†å“ã€‚

### é˜¶æ®µäºŒï¼šæ’åº â€”â€” è®©Embeddingæˆä¸ºæ¨¡å‹çš„"çœ¼ç›"

å¬å›é˜¶æ®µé€‰å‡ºçš„å‡ åƒä¸ªå•†å“ï¼Œè¿˜éœ€è¦ä¸€ä¸ªæ›´ç²¾ç»†çš„æ¨¡å‹ï¼ˆå³**ç²¾æ’æ¨¡å‹**ï¼Œå¦‚DeepFMï¼‰æ¥ç²¾å‡†é¢„ä¼°ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ï¼Œå†³å®šæœ€ç»ˆçš„å‘ˆç°é¡ºåºã€‚

åœ¨è¿™é‡Œï¼ŒEmbeddingæ‰®æ¼”äº†å¦ä¸€ä¸ªå…³é”®è§’è‰²â€”â€”**ä½œä¸ºç‰¹å¾è¾“å…¥**ã€‚
- **è¿‡å»**ï¼šç²¾æ’æ¨¡å‹çœ‹åˆ°çš„è¾“å…¥æ˜¯ `item_id=8888` è¿™ç§æ— æ„ä¹‰çš„IDã€‚
- **ç°åœ¨**ï¼šæ¨¡å‹çœ‹åˆ°çš„è¾“å…¥æ˜¯`item_embedding=[0.12, -0.45, ..., 0.88]` è¿™æ ·ä¸€ä¸ªå……æ»¡è¯­ä¹‰çš„å‘é‡ã€‚

è¿™ç­‰äºç»™æ¨¡å‹è£…ä¸Šäº†ä¸€åŒèƒ½ç†è§£å•†å“å†…åœ¨å«ä¹‰çš„"çœ¼ç›"ã€‚å®ƒä¸å†æ˜¯å¤„ç†ä¸€å †IDï¼Œè€Œæ˜¯åœ¨å¤„ç†å…·æœ‰ä¸°å¯Œå†…æ¶µçš„è¯­ä¹‰ä¿¡æ¯ï¼Œä»è€Œèƒ½å­¦ä¹ åˆ°æ›´å¤æ‚çš„äº¤å‰æ¨¡å¼ï¼Œåšå‡ºæ›´ç²¾å‡†çš„åˆ¤æ–­ã€‚

### æ‹“å±•åº”ç”¨ï¼šè§£å†³"å†·å¯åŠ¨"ç­‰ç–‘éš¾æ‚ç—‡

Embeddingçš„é­”åŠ›ä¸æ­¢äºæ­¤ï¼Œå®ƒè¿˜èƒ½ä¼˜é›…åœ°è§£å†³å¾ˆå¤šä¸šç•Œéš¾é¢˜ï¼š
- **å†·å¯åŠ¨ (Cold Start)**ï¼šä¸€ä¸ªæ–°å•†å“æ²¡æœ‰ä»»ä½•è¡Œä¸ºï¼Œå¦‚ä½•ä¸ºå®ƒç”ŸæˆEmbeddingï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒçš„**å†…å®¹ä¿¡æ¯**ï¼Œæ¯”å¦‚å°†å…¶æ–‡å­—æè¿°ï¼ˆé€šè¿‡BERTï¼‰å’Œå›¾ç‰‡ï¼ˆé€šè¿‡ResNetï¼‰è½¬æ¢æˆEmbeddingï¼Œç»™å®ƒä¸€ä¸ªåˆç†çš„åˆå§‹"å®‡å®™åæ ‡"ã€‚
- **è·¨é¢†åŸŸæ¨è**ï¼šå¯ä»¥å°†æ–°é—»çš„Embeddingå’Œå•†å“çš„Embeddingæ˜ å°„åˆ°åŒä¸€ä¸ªè¯­ä¹‰ç©ºé—´ï¼Œä»è€Œå®ç°ä»æ–°é—»åå¥½åˆ°å•†å“æ¨èçš„è·¨è¶Šã€‚

## ğŸŒŸ æ€»ç»“ï¼šä¸€åˆ‡çš†å¯Embedding

ä»ä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œåˆ°ä¸€ä¸ªåºå¤§çš„æŠ€æœ¯ä½“ç³»ï¼ŒEmbeddingå·²ç»æˆä¸ºæ·±åº¦å­¦ä¹ æ—¶ä»£å¤„ç†ç¨€ç–ã€ç¦»æ•£ç‰¹å¾çš„"æ ‡å‡†èŒƒå¼"ã€‚å®ƒå°†ä¸–é—´ä¸‡ç‰©ï¼ˆæ— è®ºæ˜¯ä¸€ä¸ªè¯ã€ä¸€ä»¶å•†å“ã€ä¸€ä¸ªç”¨æˆ·è¿˜æ˜¯ä¸€ä¸ªå¹¿å‘Šï¼‰éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå¯è®¡ç®—çš„"è¯­ä¹‰å®‡å®™"ä¸­ï¼Œè®©æˆ‘ä»¬å¾—ä»¥ç”¨æ•°å­¦çš„æ–¹å¼ï¼Œå»ç†è§£å’Œé¢„æµ‹å®ƒä»¬ä¹‹é—´å¤æ‚çš„å…³è”ã€‚

æŒæ¡Embeddingï¼Œå°±æ˜¯æŒæ¡äº†æ‰“å¼€ç°ä»£æ¨èç³»ç»Ÿå¤§é—¨çš„é’¥åŒ™ã€‚

> ğŸ§  **æ€è€ƒé¢˜**
> 
> 1.  åœ¨åŒå¡”æ¨¡å‹ä¸­ï¼Œä¸ºä»€ä¹ˆç”¨æˆ·å¡”å’Œç‰©å“å¡”çš„Embeddingé€šå¸¸éœ€è¦ä¿æŒç»´åº¦ä¸€è‡´ï¼Ÿ
> 2.  é™¤äº†ç”¨æˆ·è¡Œä¸ºåºåˆ—ï¼Œä½ è¿˜èƒ½æƒ³åˆ°å“ªäº›æ•°æ®å¯ä»¥ç”¨æ¥ä¸ºå•†å“ç”Ÿæˆæ›´æœ‰æ„ä¹‰çš„Embeddingï¼Ÿï¼ˆä¾‹å¦‚ï¼Œå•†å“çš„æ–‡æœ¬æè¿°ã€å›¾ç‰‡ã€ä»·æ ¼ã€å“ç‰Œç­‰ï¼‰
> 3.  ä½ è®¤ä¸º`king - man + woman = queen`è¿™ä¸ªç±»æ¯”ï¼Œåœ¨ç”µå•†åœºæ™¯ä¸‹çš„`iPhone - Apple + Huawei â‰ˆ Pura70`ï¼Œå…¶èƒŒåçš„æˆåŠŸæœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

ğŸ“– **å»¶ä¼¸é˜…è¯»**
1. [Efficient Estimation of Word Representations in Vector Space](https://arxiv.org/abs/1301.3781) - Word2Vec åŸå§‹è®ºæ–‡ï¼Œä¸€åˆ‡å¼€å§‹çš„åœ°æ–¹ã€‚
2. [Item2Vec: Neural Item Embedding for Collaborative Filtering](https://arxiv.org/abs/1603.04259) - å°†Embeddingæ€æƒ³è¿ç§»åˆ°æ¨èç³»ç»Ÿçš„ç»å…¸ä¹‹ä½œã€‚
3. [Billion-scale Commodity Embedding for E-commerce Recommendation in Alibaba](https://arxiv.org/abs/1803.02349) - é˜¿é‡Œå·´å·´å…³äºæ„å»ºå·¥ä¸šçº§å¤§è§„æ¨¡å•†å“Embeddingçš„é›„æ–‡ã€‚
4. [Real-time Personalization using Embeddings for Search Ranking at Airbnb](https://www.kdd.org/kdd2018/accepted-papers/view/real-time-personalization-using-embeddings-for-search-ranking-at-airbnb) - Airbnbåœ¨å®æ—¶æœç´¢æ¨èä¸­åº”ç”¨Embeddingçš„ç»å…¸æ¡ˆä¾‹ã€‚ 